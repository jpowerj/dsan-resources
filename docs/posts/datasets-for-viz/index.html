<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jeff Jacobs">

<title>DSAN Resources - Jeff’s Big Bucket of Datasets for Visualization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="../../jjcustom.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">
      DSAN Resources
      </li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">DSAN Resources</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><i class="bi bi-house pe-1"></i>Home</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#life-expectancy-by-country" id="toc-life-expectancy-by-country" class="nav-link active" data-scroll-target="#life-expectancy-by-country">Life Expectancy By Country</a></li>
  <li><a href="#perception-of-probability-words" id="toc-perception-of-probability-words" class="nav-link" data-scroll-target="#perception-of-probability-words">Perception of Probability Words</a></li>
  <li><a href="#banknote-faces" id="toc-banknote-faces" class="nav-link" data-scroll-target="#banknote-faces">Banknote Faces</a></li>
  <li><a href="#the-global-flavor-map" id="toc-the-global-flavor-map" class="nav-link" data-scroll-target="#the-global-flavor-map">The Global Flavor Map</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Jeff’s Big Bucket of Datasets for Visualization</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Datasets</div>
  </div>
  </div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Jeff Jacobs </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="mailto:jj1088@georgetown.edu" target="_blank"><code>jj1088@georgetown.edu</code></a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  

</header>

<p>There are lots of datasets out there, to the point that it can be scary trawling through e.g.&nbsp;the (at time of writing) 1,780 datasets listed in the <a href="https://docs.google.com/spreadsheets/d/1wZhPLMCHKJvwOkP4juclhjFgqIY8fQFMemwKL2c64vk/edit#gid=0" target="_blank">Data is Plural archive</a>. This point of this post, therefore, is to provide a “curated” collection of datasets specifically chosen for how well they lend themselves to various methods of <strong>visualization</strong>. For the section of DSAN 5200: Advanced Data Visualization that I’m teaching this semester (Section 03), I’ll be drawing on these datasets for demonstrations of how we can produce visual representations from raw numeric or text data.</p>
<section id="life-expectancy-by-country" class="level2">
<h2 class="anchored" data-anchor-id="life-expectancy-by-country">Life Expectancy By Country</h2>
<div id="fig-expectancy" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/04-male-versus-female-1.png" class="img-fluid figure-img"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="images/05-Comparing-two-years-1.png" class="img-fluid figure-img"></p>
</div>
</div>
</div>
<figcaption class="figure-caption">Figure&nbsp;1: <strong>Left</strong>: The life expectancy gap between males and females in 2015, by country. <strong>Right</strong>: The change in life expectancy between 2000 and 2015, by country. Both from Nathan Yau’s <a href="https://flowingdata.com/2017/01/24/one-dataset-visualized-25-ways/" target="_blank"><em>One Dataset, Visualized 25 Ways</em></a>.</figcaption>
</figure>
</div>
<p><a href="http://www.who.int/gho/mortality_burden_disease/life_tables/situation_trends/en/">The data</a>, from the World Health Organization’s <em>Global Health Observatory</em>.</p>
<ul>
<li><strong>Type</strong>: Panel (Country x Year)</li>
</ul>
<p>This is the dataset behind Nathan Yau’s blog post <a href="https://flowingdata.com/2017/01/24/one-dataset-visualized-25-ways/" target="_blank"><em>One Dataset, Visualized 25 Ways</em></a>. This post provides a great example of how data doesn’t “speak for itself”, and how visualization choices—what aspects to highlight and what aspects to exclude—can have a big impact on how underlying patterns in the data are extracted, communicated, and understood by an audience.</p>
<!-- ## Gender and Diplomatic Representation

The <a href='https://www.gu.se/en/gendip/the-gendip-dataset-on-gender-and-diplomatic-representation' target='_blank'>GenDip</a> dataset on Gender and Diplomatic Representation  -->
</section>
<section id="perception-of-probability-words" class="level2">
<h2 class="anchored" data-anchor-id="perception-of-probability-words">Perception of Probability Words</h2>
<div id="fig-perception" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/word-prob-joy.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Joyplot of the association between phrases and numeric values, from <a href="https://github.com/zonination/perceptions" target="_blank">GitHub repo</a> of reddit user zonination</figcaption>
</figure>
</div>
<ul>
<li><strong>Type</strong>: Cross-sectional (one row per respondent)</li>
<li>Survey of 123 redditors, based on a set of charts from an earlier (since-declassified) CIA publication on “Words of Estimative Probability”, data <a href="https://github.com/wadefagen/datasets/tree/master/Perception-of-Probability-Words" target="_blank">here</a></li>
<li>Visualization of a precursor to this dataset on <a href="https://d3-graph-gallery.com/graph/ridgeline_basic.html" target="_blank">D3 Graph Gallery</a></li>
<li><a href="https://waf.cs.illinois.edu/visualizations/Perception-of-Probability-Words/" target="_blank">Visualization of this data</a>, along with additional contextual details, from Illinois Computer Science professor Wade Fagen-Ulmschneider</li>
<li>Analysis from <a href="https://www.visualcapitalist.com/measuring-perceptions-of-uncertainty/" target="_blank"><em>Visual Capitalist</em></a></li>
</ul>
<p>This is one of my favorite datasets for visualization, and just for pondering in general, because it brings out the tension between the “fuzziness” of human decision-making and the <strong>numeric precision</strong> which is required for the algorithmic decision-making carried out by computers. Thinking through the visualizations of the above data on <a href="https://waf.cs.illinois.edu/visualizations/Perception-of-Probability-Words/" target="_blank">this page</a> “in reverse” can help us understand how <em>humans</em> perceive the outputs of probabilistic machine learning algorithms: there is a sense in which an “average” human (generalizing speculatively from this small-<span class="math inline">\(N\)</span> survey!) will interpret an algorithm’s output of 0.95 as an “almost certain” result, while a result between 0.15 and 0.30 will be interpreted by ~50% of humans as a “probably not” result.</p>
</section>
<section id="banknote-faces" class="level2">
<h2 class="anchored" data-anchor-id="banknote-faces">Banknote Faces</h2>
<div id="fig-banknotes" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/banknotes_death.jpeg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;3: From the <a href="https://pudding.cool" target="_blank">pudding.cool</a> article <a href="" target="_blank">Who’s In Your Wallet?</a>, visualizing the gaps between when a public figure died and when their face was put on a country’s banknotes.</figcaption>
</figure>
</div>
<ul>
<li>Type: Cross-sectional (one row per person)</li>
<li>Data available via the <a href="https://github.com/the-pudding/banknotes/tree/master/src/data" target="_blank">GitHub repo</a> for the article</li>
</ul>
<p><a href="https://pudding.cool" target="_blank">pudding.cool</a> is one of my favorite websites of all time, and has dozens and dozens of fascinating datasets and analyses, but this one I think is really straightforward yet lends itself to lots of different visualizations, like the one presented above plotting the gaps in time between when a person died and when their face was placed on a country’s banknotes. One of my favorite aspects about this plot is how it leads the viewer (and by the viewer I specifically mean me! But, I would guess that others may be intrigued by this aspect as well?) to want to know what the “corner cases” represent: who is the one person who died ~2000 years before they were placed on a bill? Or, who are the 10 people who were still alive when their face was placed on a banknote? I guess you’ll have to go in and explore the data (or read the pudding.cool article) to find out! (Or click the text below to reveal the answers, if you want to cheat 😜)</p>
<details>
<summary>
(Click for the gist if you don’t want to read the article!)
</summary>
<ul>
<li>The outlier in terms of dying ~2000 years before being placed on a bill is <a href="https://en.wikipedia.org/wiki/Hannibal" target="_blank">Hannibal</a>, who died around 182 BC and was placed on the 5 Tunisian Dinar bill <a href="https://www.leftovercurrency.com/exchange/tunisian-dinars/current-tunisian-dinar-banknotes/5-tunisian-dinars-banknote-hannibal/" target="_blank">in 2013</a>.</li>
<li>The ten outliers who lived to see their own faces on a banknote are (in chronological order of banknote issue):
<ol type="1">
<li><a href="https://en.wikipedia.org/wiki/Mustafa_Kemal_Atat%C3%BCrk" target="_blank">Mustafa Kemal Atatürk</a>, placed on Turkish Lira note in 1927 and died in 1938</li>
<li><a href="https://en.wikipedia.org/wiki/Sukarno" target="_blank">Sukarno</a>, placed on Indonesian Rupiah note in 1945 and died in 1970</li>
<li><a href="https://en.wikipedia.org/wiki/Michael_Manley" target="_blank">Michael Manley</a> of Jamaica, placed on Jamaican Dollar note in 1970 and died in 1997</li>
<li><a href="https://en.wikipedia.org/wiki/Hastings_Banda" target="_blank">Hastings Banda</a> of Malawi, placed on Malawian Kwacha note in 1971 and died in 1997</li>
<li><a href="https://en.wikipedia.org/wiki/Sheikh_Mujibur_Rahman" target="_blank">Sheikh Mujibur Rahman</a>, placed on Bangladeshi Taka note in 1972 and died in 1975</li>
<li><a href="https://en.wikipedia.org/wiki/Michael_Somare" target="_blank">Michael Somare</a>, placed on Papua New Guinean Kina note in 1989, died in 2021</li>
<li><a href="https://en.wikipedia.org/wiki/Edmund_Hillary" target="_blank">Edmund Hillary</a>, placed on New Zealand Dollar note in 1992, died in 2008</li>
<li><a href="https://en.wikipedia.org/wiki/Rose_Chibambo" target="_blank">Rose Chibambo</a>, placed on Malawian Kwacha note in 2012, died in 2016</li>
<li><a href="https://en.wikipedia.org/wiki/Nelson_Mandela" target="_blank">Nelson Mandela</a>, placed on South African Rand note in 2012, died in 2013</li>
<li><a href="https://en.wikipedia.org/wiki/Elizabeth_II" target="_blank">Queen Elizabth II</a> of England, placed on British Pound note in 1963, died in 2022</li>
</ol></li>
</ul>
</details>
</section>
<section id="the-global-flavor-map" class="level2">
<h2 class="anchored" data-anchor-id="the-global-flavor-map">The Global Flavor Map</h2>
<div id="fig-flavor-network" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/flavor-network.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4: A high-level view of the “global flavor network” developed and studied in <span class="citation" data-cites="ahn_flavor_2011">Ahn et al. (<a href="#ref-ahn_flavor_2011" role="doc-biblioref">2011</a>)</span></figcaption>
</figure>
</div>
<ul>
<li><strong>Type</strong>: Network data (Nodes are ingredients, edges between two nodes represent shared molecular properties)</li>
<li>The data: available at the bottom of the <a href="https://www.nature.com/articles/srep00196" target="_blank">page for the paper</a>, as “Supplementary Dataset 1”</li>
</ul>
<p>It’s difficult to choose a good dataset to demonstrate visualization of network data, honestly, since sometimes “good” means that it is simple enough to capture using just a few nodes and a few edges, while other times “good” means that it is rich/complex enough to warrant generating a bunch of different visualizations showing different facets of the data. I think this dataset falls more into the latter case, but I like it in terms of generating the visualization reproduced above, since it shows how you could generate simple “summary” visualizations of the dataset, but (as done in the paper from which the figure is taken) you can also do a deep dive into the dataset—down into the molecular level, for example—to find other interesting patterns that too “fine grained” to be present in the above (high-level/coarse-grained) visualization.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-ahn_flavor_2011" class="csl-entry" role="listitem">
Ahn, Yong-Yeol, Sebastian E. Ahnert, James P. Bagrow, and Albert-László Barabási. 2011. <span>“Flavor Network and the Principles of Food Pairing.”</span> <em>Scientific Reports</em> 1 (1): 196. <a href="https://doi.org/10.1038/srep00196">https://doi.org/10.1038/srep00196</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>